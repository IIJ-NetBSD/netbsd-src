# $NetBSD: CHANGES-11.0,v 1.1.2.35 2025/11/14 13:32:36 martin Exp $

A complete list of changes from the initial NetBSD 11.0 branch on 2025-07-30
until the 11.0 release:

doc/CHANGES-11.0				created
doc/LAST_MINUTE 				patched by hand
doc/README.files				patched by hand
external/gpl2/groff/tmac/mdoc.local		patched by hand
sys/sys/param.h 				patched by hand

	Welcome to 11.0_BETA!

sys/arch/i386/stand/boot/boot2.c		1.90
sys/arch/i386/stand/efiboot/boot.c		1.33

	x86: boot(8): reorder the pathes tried to load the kernel
	to avoid confusing loader messages.
	[pgoyette, ticket #3]

doc/CHANGES					(manually edited)

	fix typo

usr.sbin/sysinst/util.c				1.78

	sysinst(8): PR 59573: do not leave temporary files behind.
	[kim, ticket #4]

etc/named.conf					1.12-1.14

	named(8): adjust the default configuration following
	recommendations from https://www.dnsflagday.net/2020/.
	[kim, ticket #5]

sys/arch/amd64/conf/GENERIC			1.617
sys/arch/evbarm/conf/GENERIC64			1.227
sys/dev/pci/files.pci				1.451
sys/dev/pci/pvscsi.c				1.1,1.2
sys/dev/pci/pvscsi.h				1.1

	Add support for the VMware PV SCSI controller found
	in VMware's ESXi product.
	[skrll, ticket #6]

lib/libc/stdio/mktemp.3				1.36

	mkostemp(3): include O_CLOFORK in mkostemp()'s allowed flags.
	[kre, ticket #7]

lib/libc/stdlib/posix_openpt.3			1.11
sys/kern/tty_ptm.c				1.47
tests/lib/libc/ttyio/t_ptm.c			1.3

	posix_openpt(3): support O_CLOFORK.
	[gutteridge, ticket #8]

crypto/external/apache2/openssl/lib/libssl/Makefile 1.5

	libssl: link against libcrypto (again).
	[wiz, ticket #9]

sys/netipsec/ipsec_input.c			1.82

	ipsec: fix "no key association" log.
	[knakahara, ticket #10]

usr.sbin/npf/npfctl/npf_build.c			1.61

	npfctl(8): fix segfault with pcap-filter.
	[kim, ticket #11]

usr.sbin/npf/npfctl/npf_build.c			1.60

	npfctl(8): PR 59581: set layer 3 bit in dynamic rule attributes.
	[joe, ticket #12]

sys/arch/x86/conf/MICROVM.common		1.4

	x86: PR 59568: disable viogpu in MICROVM kernel configuration.
	[imil, ticket #13]

sys/arch/amd64/conf/MICROVM			1.4
sys/arch/i386/conf/MICROVM			1.4

	x86: add `+invtsc` to the QEMU command line example.
	[imil, ticket #14]

sys/netbt/hci.h					1.47

	blutooth: fix definition of Sniff Subrating command.
	[plunky, ticket #15]

external/lgpl2/userspace-rcu/lib/liburcu-signal/Makefile 1.2
external/lgpl2/userspace-rcu/lib/liburcu/Makefile 1.2
external/mpl/bind/Makefile.inc			1.18
external/mpl/bind/bind2netbsd			1.11
external/mpl/bind/include/config.h		1.24

	named: use liburcu-mb on netbsd.
	[mrg, ticket #16]

share/man/man7/hier.7				1.145

	hier(7): add entry for /var/shm.
	[kim, ticket #17]

distrib/notes/common/contents			1.188
etc/etc.amd64/Makefile.inc			1.18
etc/etc.i386/Makefile.inc			1.71

	x86: distribute the MICROVM kernel.
	See sys/arch/{amd64,i386}/conf/MICROVM for usage instructions.
	[imil, ticket #18]

sys/arch/virt68k/conf/GENERIC			1.11

	virt68k: disable viogpu(4) in GENERIC kernel.
	[isaki, ticket #19]

sys/arch/m68k/m68k/mmu_subr.s			1.4

	m68k: avoid a panic during boot on some machines.
	The PMOVE <ea>,TTn instruction does not support (An)+ addressing mode
	on 68030.
	[isaki, ticket #20]

distrib/sets/lists/man/mi			1.1810
distrib/sets/lists/manhtml/mi			1.31
share/man/man4/Makefile				1.748
share/man/man4/genet.4				1.1,1.2

	genet(4): add man page.
	[wiz, ticket #21]

sys/net/nd.c					1.8
tests/net/arp/t_arp.sh				1.49

	nd: PR 59596: fix the number of requests for address resolution.
	[ozaki-r, ticket #22]

distrib/miniroot/install.sh			1.29

	sun3: place a ptyfs instance into the newly-written /etc/fstab,
	so that e.g. sshd works out of the box after installation.
	[thorpej, ticket #23]

bin/sh/cd.c					1.54-1.56

	sh(1): PR 59565: cd "" is now an error, not == cd .
	Improve error messages from the "cd" builtin.
	[kre, ticket #24]

sys/arch/arm/cortex/gicv3.c			1.55,1.56

	gicv3: Appease KUBSAN (avoid undefined left-shift out of range).
	[rin, ticket #25]

external/gpl3/binutils/dist/gas/config/tc-vax.c	1.22

	vax: gas: PR 59326: use GOT for pointer for global function
	in same file, instead of PLT.
	[rin, ticket #26]

share/examples/devpubd/hooks/99-ugen-perms-minipro 1.2

	devpubd(8): update for newer "minipro" programmers:
	- T48 / T56 use the same USB VID/PID as the TL866II+.
	- Add the T76 USB VID/PID.
	[thorpej, ticket #27]

tests/kernel/t_umount.sh			1.9

	Update the kernel/t_umount test program to match new sh diagnostic.
	[christos, ticket #28]

sys/dev/usb/if_urtwn.c				1.113-1.117

	urtwn(4): 
	- Set the pipe index on usb xfer creation.
	- Plug an xfer leak in the tx error path.
	- Use the right packet spacing for the 8192EU.
	- Ensure that the receive packet processing does not exceed
	  beyond xfer length.
	[nat, ticket #29]

sys/dev/usb/xhci.c				1.190

	xhci(4): Handle special case of USBD_FORCE_SHORT_XFER.  This
	fixes devices such as urtwn(4) connected to an xhci port.
	[nat, ticket #30]

sys/dev/fdt/fdt_platform.c			1.3
sys/dev/fdt/files.fdt				1.75 via patch
sys/arch/arm/fdt/files.fdt			1.37
sys/arch/riscv/fdt/files.fdt			1.5

	Fix NULL-dereference crash during boot.
	[rin, ticket #31]

sys/dev/hdaudio/hdaudiodevs			1.13
sys/dev/hdaudio/hdaudiodevs.h			(regen)
sys/dev/hdaudio/hdaudiodevs_data.h		(regen)

	hdaudio(4): add NVIDIA GK208, REALTEK ALC897
	[nia, ticket #32]

sys/arch/hppa/hppa/trap.c			1.124-1.128

	hppa: fix inverted logic around probe access vs probe access immediate
	instructions and cleanup.
	[skrll, ticket #33]

usr.bin/elf2ecoff/elf2ecoff.c			1.37,1.38

	elf2ecoff: PR 59234: fix buffer overflow.
	[tsutsui, ticket #34]

external/cddl/osnet/dist/tools/ctf/cvt/ctfconvert.c 1.7
external/cddl/osnet/dist/tools/ctf/cvt/fixup_tdescs.c 1.8,1.9

	ctfconvert(1): PR 59659: make the tool version behave the same
	way as the native.
	[ozaki-r, ticket #35]

crypto/external/apache2/openssl/lib/libcrypto/Makefile 1.2
distrib/sets/lists/comp/mi			1.2498

	openssl(3): install thread.h.
	[christos, ticket #36]

bin/sh/option.list				1.12

	sh(1): PR 59646: improve portability of option code generation
	[kre, ticket #37]

sys/arch/riscv/riscv/bus_dma.c			1.11

	risc-v: PR 59653: adjust barriers issued in bus_dmamap_sync
	for the coherent case.
	[skrll, ticket #38]

external/apache2/mDNSResponder/dist/mDNSPosix/PosixDaemon.c 1.20

	mdnsd(8): PR 58778: mDNS spams console with recent build,
	default logging to off.
	[skrll, ticket #39]

sys/arch/arm/arm32/bus_dma.c			1.150
sys/arch/arm/include/cpufunc.h			1.92

	arm: PR 59654: adjust barriers issued in bus_dmamap_sync
	for the coherent case.
	[skrll, ticket #40]

share/man/man3/intro.3				1.37,1.38

	intro(3): PR 59676: remove reference to non-existent -lhesiod.
	[uwe, ticket #41]

external/gpl2/texinfo/dist/info/display.c	1.2

	info(1): fix ctype(3) usage to avoid coredump.
	[wiz, ticket #42]

sys/arch/amd64/amd64/locore.S			1.231-1.233
sys/arch/i386/i386/locore.S			1.202-1.204
sys/arch/xen/xen/hypervisor.c			1.100

	xen: fix PVH bootstrap code, don't assume the hvm_start_info structure
	is at the end of the symbol table.
	Fixes PVH dom0 boot under Xen 4.20.
	[bouyer, ticket #43]

sys/dev/usb/ehci.c				1.333

	ehci(4): fix device-probe for some machines.
	[rin, ticket #44]

distrib/sets/lists/debug/mi			1.486
distrib/sets/lists/tests/mi			1.1394
lib/libc/gen/ctype.3				1.32,1.33
lib/libc/gen/ctype_.c				1.24
lib/libc/gen/ctype_guard.h			1.8
lib/libc/gen/isctype.c				1.29
lib/libc/gen/tolower_.c				1.18
lib/libc/gen/toupper_.c				1.18
lib/libc/locale/Makefile.inc			1.69
lib/libc/locale/rune.c				1.50
tests/lib/libc/gen/Makefile			1.61
tests/lib/libc/gen/h_ctype_abuse.c		1.1
tests/lib/libc/gen/h_ctype_abuse.c		1.2
tests/lib/libc/gen/t_ctype.c			1.12

	ctype(3): PR : environment override for abuse traps.
	[riastradh, ticket #45]

distrib/utils/libhack/Makefile.inc		1.40
lib/libc/gen/sysctl.c				1.39

	sysctl: avoid descriptions in small install media.
	[christos, ticket #46]

tests/lib/libc/kevent_nullmnt/t_nullmnt.sh	1.9

	PR 59683: fix nullfs presence test in test
	libc/kevent/t_nullmnt.
	[kre, ticket #47]

sys/arch/riscv/riscv/cpu.c			1.8,1.9
sys/arch/riscv/riscv/trap.c			1.31

	riscv:	attach the fpu loads, save and reenable event counters.
	[skrll, ticket #48]

sys/compat/linux/common/linux_sched.c		1.84,1.85
sys/compat/linux/common/linux_sched.h		1.12

	compat_linux: PR 59608: fix stack address and ignore sysvsem flag.
	[christos, ticket #49]

sys/dev/usb/xhci.c				1.192

	xhci(4): PR 59678: do not generate duplicate events when sending ZLP.
	[nat, ticket #50]

distrib/sets/lists/comp/mi			1.2501 (patch)
distrib/sets/lists/debug/ad.mips		1.86 (patch)
distrib/sets/lists/debug/shl.mi			1.374 (patch)

	set lists: mark old gcc=9 conditional entries as obsolete
	or just remove them.
	[nakayama, ticket #51]

sys/net/npf/npf_socket.c			1.4

	npf: PR 59681: take the softnet lock when accessing a sockets
	user/group credentials.
	[joe, ticket #52]

sys/net/npf/npf.h				1.68
sys/net/npf/npf_ruleset.c			1.57

	npf: PR 59615: add compat support for netbsd-10 userland.
	[joe, ticket #53]

sys/arch/evbppc/wii/dev/rtcsram.c		1.4,1.5

	wii: fix reading values from Wii's SRAM.
	[hgutch, ticket #54]

usr.bin/calendar/calendars/calendar.christian	1.15
usr.bin/calendar/calendars/calendar.holiday	1.36
usr.bin/calendar/calendars/calendar.judaic	1.13
usr.bin/calendar/calendars/calendar.netbsd	1.52
usr.bin/calendar/calendars/calendar.usholiday	1.13

	Calendar update for 2026.
	[jnemeth, ticket #55]

lib/libc/stdio/mkstemps.c			1.2
tools/compat/Makefile				1.95
tools/compat/compat_defs.h			1.126,1.127
tools/compat/configure				1.108,1.109
tools/compat/configure.ac			1.110,1.111
tools/compat/nbtool_config.h.in			1.59-1.61

	build: fixes to allow building with modern compilers.
	[mrg, ticket #56]

sys/kern/subr_time.c				1.42
sys/kern/subr_time_arith.c			1.4,1.5
tests/kernel/t_time_arith.c			1.4-1.7

	tstohz(9): PR 59691: fix rounding direction for timeouts.
	[riastradh, ticket #57]

sys/dev/usb/usb_subr.c				1.280,1.281
sys/dev/usb/usbdivar.h				1.140
sys/dev/usb/xhci.c				1.191

	usbdi(9): PR 59185, 59624, 57447: fix state for	selected config index.
	[riastradh, ticket #58]

lib/libc/gen/ctype.3				1.34,1.35

	ctype(3): PR 58208: fix versions and clarify prose in man page.
	[riastradh, ticket #59]

common/lib/libc/arch/i386/atomic/atomic.S	1.38
common/lib/libc/arch/sparc/atomic/membar_ops.S	1.9
common/lib/libc/arch/sparc64/atomic/membar_ops.S 1.10
common/lib/libc/arch/x86_64/atomic/atomic.S	1.32
distrib/sets/lists/comp/mi			1.2499
share/man/man9/Makefile				1.475
share/man/man9/paravirt_membar_sync.9		1.1
sys/arch/alpha/alpha/locore.s			1.145
sys/arch/amd64/amd64/cpufunc.S			1.70
sys/arch/arm/arm/cpu_subr.c			1.6
sys/arch/hppa/hppa/support.S			1.9
sys/arch/i386/i386/cpufunc.S			1.54
sys/arch/mips/mips/cpu_subr.c			1.65,1.66
sys/arch/riscv/riscv/cpu_subr.c			1.6
sys/arch/sparc/sparc/locore.s			1.287
sys/arch/sparc64/sparc64/locore.s		1.436
sys/arch/virt68k/virt68k/locore.s		1.17
sys/sys/paravirt_membar.h			1.1

	paravirt_membar(9): PR 59618: new membar for paravirtualized
	drivers.
	[riastradh, ticket #60]

sys/dev/hyperv/vmbus.c				1.20

	hyperv(4): PR 59618: use paravirt_membar_sync(9) where needed.
	[riastradh, ticket #61]

sys/dev/pci/virtio.c				1.84

	virtio(4): PR 59618: use paravirt_membar_sync(9) where needed.
	[riastradh, ticket #62]

sys/dev/pci/pvscsi.c				1.3

	pvscsi(4): PR 59618: use paravirt_membar_sync(9) where needed.
	[riastradh, ticket #63]

sys/dev/pci/pvscsi.c				1.4,1.5

	pvscsi(4): fix bus_dma syncs (related to PR 59618).
	[riastradh, ticket #64]

sys/dev/ic/bwi.c				1.44

	bwi(4): retry SDIO common regwin probe a few times before giving up.
	[jmcneill, ticket #65]

sys/arch/amd64/conf/ALL				1.194
sys/arch/amd64/conf/GENERIC			1.618
sys/arch/i386/conf/ALL				1.524
sys/arch/i386/conf/GENERIC			1.1261
sys/arch/x86/acpi/acpi_machdep.c		1.40
sys/arch/x86/include/mpacpi.h			1.12
sys/arch/x86/x86/mpacpi.c			1.112
sys/dev/acpi/acpi_mcfg.h			1.6

	x86: PR 59118: kernel option PCI_RESOURCE.
	[riastradh, ticket #66]

sys/arch/riscv/include/pmap.h			1.25
sys/arch/riscv/include/pte.h			1.15,1.16
sys/arch/riscv/include/sysreg.h			1.34
sys/arch/riscv/riscv/bus_space.c		1.3
sys/arch/riscv/riscv/cpu.c			1.10
sys/arch/riscv/riscv/genassym.cf		1.17
sys/arch/riscv/riscv/locore.S			1.47
sys/arch/riscv/riscv/pmap_machdep.c		1.22,1.23
sys/arch/riscv/riscv/riscv_machdep.c		1.46

	riscv: deal with the non-standard XTheadMae (Memory Attribute
	Extensions) present on some T-Head CPU cores, notably the one
	found in the Allwinner D1 SoC.
	[skrll, ticket #67]

sys/arch/riscv/include/pte.h			1.17

	risc-v: PR 59696: pte_make_enter set PTE_D when page is known to
	be modified.
	[skrll, ticket #68]

sys/dev/ic/bwi.c				1.45
sys/dev/ic/bwireg.h				1.6
sys/dev/ic/bwivar.h				1.12

	bwi(4): AMRR fix, PCI/cardbus interrupt fix, and other enhancements.
	[jmcneill, ticket #69]

xsrc/external/mit/xf86-video-geode/dist/src/geode_msr.c 1.8

	geode: avoid reading /dev/cpu/0/msr, which does not exist.
	[nia, ticket #70]

share/man/man4/viaide.4				1.13
sys/dev/pci/pcidevs				1.1528
sys/dev/pci/pcidevs.h				(regen)
sys/dev/pci/pcidevs_data.h			(regen)
sys/dev/pci/viaide.c				1.105

	viaide(4): add UDMA support for VT8233C IDE controller.
	[andvar, ticket #71]

sys/arch/evbppc/wii/dev/resetbtn.c		1.3

	evbppc: wii: make the reset button work at the ddb> prompt.
	[jmcneill, ticket #72]

sys/arch/arm/amlogic/meson_usbctrl.c		1.7

	arm: support the amlogic,meson-gxl-usb-ctrl as found in the
	Libre Computer AML-S905X-CC.
	[skrll, ticket #73]

sys/arch/evbppc/include/wii.h			1.11
sys/arch/evbppc/wii/dev/gxreg.h			1.1
sys/arch/evbppc/wii/dev/viio.h			delete
sys/arch/evbppc/wii/dev/wiifb.c			1.8
sys/arch/evbppc/wii/machdep.c			1.11

	evbppc: wii: use GX to accelerate RGB to YUY2 conversion.
	[jmcneill, ticket #74]

external/bsd/blocklist/bin/blocklistctl.8	1.5,1.6
external/bsd/blocklist/bin/blocklistctl.c	1.5
external/bsd/blocklist/bin/blocklistd.c		1.11,1.12
external/bsd/blocklist/bin/state.c		1.3

	blocklistd(8): PR 57193: various changes
	- avoid infinite loop
	- improve documentation
	- improve logging
	- do not close the file descriptor in process
	[christos, ticket #75]

sys/dev/hdaudio/hdafg.c				1.33

	hdaudio(4): PR 59712: do not expose non-functional volume controls.
	[nia, ticket #76]

usr.bin/aiomixer/parse.c			1.4

	aiomixer(1): always put "master" controls first.
	[nia, ticket #77]

sys/dev/hdaudio/hdaudio_mixer.h			1.2

	hdaudio(4): rename "record" mixer control to "imonitor".
	[nia, ticket #78]

sys/dev/pci/aac_pci.c				1.43
sys/dev/pci/pcidevs				1.1533
sys/dev/pci/pcidevs.h				(regen)
sys/dev/pci/pcidevs_data.h			(regen)

	aac(4): add support for Adaptec RAID 5445, 5805 and 5085.
	[riz, ticket #79]

distrib/sets/lists/man/mi			1.1812
distrib/sets/lists/manhtml/mi			1.33
share/man/man4/man4.sparc64/Makefile		1.10
share/man/man4/man4.sparc64/psycho.4		1.1
share/man/man4/man4.sparc64/schizo.4		1.1

	sparc64: add some man pages for pci buses.
	[nia, ticket #80]

sys/dev/rasops/rasops.c				1.129
sys/dev/rasops/rasops.h				1.52
sys/dev/rasops/rasops_putchar.h			1.9
sys/dev/wscons/wsdisplayvar.h			1.58
sys/dev/wscons/wsemul_vt100_subr.c		1.35

	wscons(4): PR 59544: add support for 256 colours to VT100 emulation.
	Also implemented are CSI 90-97 and CSI 100-107 to set the bright
	versions of the regular eight colours directly.
	[nia, ticket #81]

sys/arch/evbppc/conf/WII			1.10
sys/arch/evbppc/conf/files.wii			1.7
sys/arch/evbppc/include/wii.h			1.12
sys/arch/evbppc/wii/dev/hwaes.c			1.1

	evbppc: wii: add support for hardware AES engine and cgd(4)
	to the WII kernel.
	[jmcneill, ticket #82]

external/bsd/dhcpcd/dist/src/if-bsd.c		1.35
external/bsd/dhcpcd/dist/src/route.c		1.3,1.4

	dhcpcd(8): PR 59664: fix routing updates.
	[roy, ticket #83]

